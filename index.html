<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8">
<title>The Oath Beavers Association - Membership Card Creator Tool</title>
<link rel="icon" href="oath.png" type="image/png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">
</head>

<body>
<div class="page-wrapper">
  <section class="hero-section">
    <div class="warn-box">
  <i class="fa-solid fa-circle-info" style="color: #2f8fed;"></i> 
  Bu araÃ§, "The Oath Beavers Association" Ã¼yelik kartlarÄ±nÄ± oluÅŸturmak iÃ§indir. 
  Her karakterin yanlÄ±zca bir adet "The Oath Beavers Association" Ã¼yelik kartÄ± bulunabilir.
</div>
    <div class="card-section">
    <!-- SOL TARAF: FORM PANELÄ° -->
    <div class="panel">
      <span class="title">Ãœyelik KartÄ± OluÅŸtur</span>
      <label>FotoÄŸraf</label>
      <input class="custom-file-input" type="file" id="photoInput" accept="image/*" hidden required>
      <div class="drop-area">
        <i class="fa fa-upload"></i>
    <span>Resmi yÃ¼klemek iÃ§in sÃ¼rÃ¼kleyip bÄ±rakÄ±n veya buraya tÄ±klayÄ±n</span>
</div>
     
      <label>Ä°sim</label>
      <input type="text" id="nameInput" placeholder="Ad Soyad" required value="Jane Doe">

      <label>Cinsiyet</label>
      <select id="sexInput" required>
        <option value="Female">Female</option>
        <option value="Male">Male</option>
      </select>

      <label>Servis</label>
      <select id="serviceInput" required>
        <option value="District Attorneyâ€™s Office">District Attorneyâ€™s Office</option>
        <option value="LS County Sheriff's Department">LS County Sheriff's Department</option>
        <option value="LS Police Department">LS Police Department</option>
        <option value="LS Fire Department">LS Fire Department</option>
        <option value="SA Department of Corrections">SA Department of Corrections</option>
        <option value="LS City Government">LS City Government</option>
      </select>

      <label>ID</label>
      <input type="number" id="idInput" placeholder="YalnÄ±zca Ticket NO" required value="0000">
      <button id="downloadBtn" type="submit" style="margin-top: 2rem;">PNG Ä°ndir</button>
    </div>
 <!-- SAÄ TARAF: KART Ã–NÄ°ZLEME -->
    <div class="preview">
      <canvas id="cardCanvas"></canvas>
    </div>
  </div>

  </section>

  <!-- ÃœYELÄ°K KARTI OLUÅTURMA BÃ–LÃœMÃœ -->
   <section class="info-section">
    <div class="info-box">
      <span class="title">1</span>
        <div class="command" id="command">/myitemsex</div>
          <p class="note">
              Bu komut, envanterinizdeki <span class="important">note kartlarÄ±nÄ±n listesini</span> gÃ¶rmenizi saÄŸlar ve hangi numarada olduÄŸunu Ã¶ÄŸrenmenize yardÄ±mcÄ± olur. BÃ¶ylece bir sonraki adÄ±mlarda doÄŸru kart Ã¼zerinde iÅŸlem yapabilirsiniz.
          </p>
          <div class="command" id="command">/note x 1 ad <b>The Oath Beavers - Ãœyelik KartÄ±</b></div>
          <p class="note">
              Burada <span class="important">"x"</span> yerine envanterinizdeki kartÄ±n numarasÄ±nÄ± yazmanÄ±z gerekiyor. Bu komut, seÃ§tiÄŸiniz kartÄ±n adÄ±nÄ± deÄŸiÅŸtirmeye veya doÄŸrulamaya yarar. KartÄ±n adÄ± mutlaka <span class="important">"The Oath Beavers - Ãœyelik KartÄ±"</span> olmalÄ±dÄ±r.
          </p>
          
      </div>
    
    <div class="info-box">
      <span class="title">2</span>
          <div class="command" id="command">/iconpicker</div>
          <p class="note">
              Bu komutu yazdÄ±ÄŸÄ±nÄ±zda, Ã¶nÃ¼nÃ¼ze bir ikon seÃ§im menÃ¼sÃ¼ Ã§Ä±kar. MenÃ¼de <span class="important">"DiÄŸer"</span> kÄ±smÄ±na gidip Ã¼Ã§Ã¼ncÃ¼ satÄ±rÄ±n soldan dÃ¶rdÃ¼ncÃ¼ simgesini seÃ§melisiniz. SeÃ§tiÄŸiniz ikon, kartÄ±n gÃ¶rsel temsili olarak kullanÄ±lacaktÄ±r.
          </p>
          <div class="command" id="command">/note x 1 ikon</div>
          <p class="note">
              Bu komut, iconpicker ile seÃ§tiÄŸiniz ikonu kartÄ±nÄ±za uygular. KartÄ±n gÃ¶rÃ¼nÃ¼mÃ¼nÃ¼ kiÅŸiselleÅŸtirmek ve tanÄ±nmasÄ±nÄ± saÄŸlamak iÃ§in bu adÄ±m Ã¶nemlidir. <span class="important">"x"</span> yine kartÄ±n envanter numarasÄ±dÄ±r.
          </p>
    </div>
    <div class="info-box">
      <span class="title">3</span>
      <div class="command" id="command">/note x 1 iÃ§erik https://i.imgur.com/Assokbk.jpeg</div>
        <p class="note">
            Bu komut, kartÄ±n iÃ§erisine gÃ¶rsel veya metin eklemenizi saÄŸlar. Buradaki Ã¶rnek link, imgur Ã¼zerinde Ã¶nceden yÃ¼klenmiÅŸ bir gÃ¶rseldir. Kendi hazÄ±rladÄ±ÄŸÄ±nÄ±z kart gÃ¶rselini kullanmak iÃ§in, resmi imgura yÃ¼kleyin, saÄŸ tÄ±klayÄ±p â€œresim adresini kopyalaâ€ yapÄ±n ve linki buraya yapÄ±ÅŸtÄ±rÄ±n. Bu adÄ±m, kartÄ±n iÃ§eriÄŸinin gÃ¶rsel olarak tamamlanmasÄ±nÄ± saÄŸlar ve kartÄ±n hem gÃ¶rÃ¼nÃ¼mÃ¼nÃ¼ hem de iÅŸlevini tamamlar.
        </p>
    </div>
   </section>
  <!-- ALT BÄ°LGÄ° / REHBER ALANI -->

</div>
<script>
// Canvas iÅŸlemleri
const canvas = document.getElementById('cardCanvas');
const ctx = canvas.getContext('2d');
const nameInput = document.getElementById('nameInput');
const sexInput = document.getElementById('sexInput');
const serviceInput = document.getElementById('serviceInput');
const idInput = document.getElementById('idInput');
const photoInput = document.getElementById('photoInput');
const dropArea = document.querySelector('.drop-area');
const dropText = dropArea.querySelector('span');
const downloadBtn = document.getElementById('downloadBtn');

let photoImg = null;
let templateImg = new Image();

templateImg.onload = () => {
  canvas.width = templateImg.width;
  canvas.height = templateImg.height;
  render();
};
templateImg.src = "sablon.png";

function render() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.drawImage(templateImg, 0, 0);

  if (photoImg) {
    const x = 392, y = 794.3, w = 348, h = 470;
    ctx.save();
    ctx.beginPath();
    ctx.rect(x, y, w, h);
    ctx.clip();
    drawImageCover(ctx, photoImg, x, y, w, h);
    ctx.restore();
  }

  ctx.fillStyle = '#000';
  ctx.textBaseline = 'top';
  ctx.font = 'bold 40px Arial';
  ctx.fillText(nameInput.value || '', 1000, 820);
  ctx.font = '40px Arial';
  ctx.fillText(sexInput.value || '', 1000, 867);
  ctx.fillText(serviceInput.value || '', 1000, 910);
  ctx.fillStyle = '#ff0000d9';
  ctx.fillText(idInput.value || '', 1000, 955);

  const canvasEl = document.getElementById("cardCanvas");

  canvasEl.style.opacity = 0;
  canvasEl.style.transform = 'scale(0.95)';

  setTimeout(() => {
    canvasEl.style.opacity = 1;
    canvasEl.style.transform = 'scale(1)';
  }, 50);
  }

function drawImageCover(ctx, img, x, y, w, h) {
  const iw = img.width, ih = img.height;
  const r = Math.max(w / iw, h / ih);
  const nw = iw * r, nh = ih * r;
  const cx = (nw - w) / 2, cy = (nh - h) / 2;
  ctx.drawImage(img, -cx + x, -cy + y, nw, nh);
}
function handleFile(file) {
  if (!file) return;

  dropText.textContent = `Dosya YÃ¼klendi: ${file.name}`;

  const img = new Image();
  img.onload = () => {
    photoImg = img;
    render();
  };
  img.src = URL.createObjectURL(file);
}
dropArea.addEventListener('click', () => {
  photoInput.click();
});

// Input deÄŸiÅŸtiÄŸinde (tÄ±klayÄ±p seÃ§ince)
photoInput.addEventListener('change', (e) => {
  handleFile(e.target.files[0]);
});

// Dosya sÃ¼rÃ¼kleniyorsa stil deÄŸiÅŸsin
dropArea.addEventListener('dragover', (e) => {
  e.preventDefault();
  dropArea.style.borderColor = 'cadetblue';
  dropText.textContent = `BÄ±rak yÃ¼kle!`;
});

// SÃ¼rÃ¼kleme iptal edilirse stile geri dÃ¶n
dropArea.addEventListener('dragleave', () => {
  dropArea.style.borderColor = '#333';
  dropText.textContent = `Resmi yÃ¼klemek iÃ§in sÃ¼rÃ¼kleyip bÄ±rakÄ±n veya buraya tÄ±klayÄ±n`;
});

// Dosya bÄ±rakÄ±ldÄ±ÄŸÄ±nda
dropArea.addEventListener('drop', (e) => {
  e.preventDefault();
  dropArea.style.borderColor = '#333';
  const file = e.dataTransfer.files[0];
  if (file) {
    photoInput.files = e.dataTransfer.files; // input'u gÃ¼ncel tut
    handleFile(file);
  }
});

[nameInput, sexInput, serviceInput, idInput].forEach(input => {
  input.addEventListener('input', render);
  input.addEventListener('change', render);
});

function triggerButtonError(){
  downloadBtn.classList.add('error');
  setTimeout(() => downloadBtn.classList.remove('error'), 800);
}
function validateInputs() {
  const fields = [
    { el: photoInput, condition: photoInput.files.length, highlight: dropArea },
    { el: nameInput, condition: nameInput.value.trim() },
    { el: idInput, condition: idInput.value.trim() }
  ];

  let valid = true;

  fields.forEach(f => {
    if (!f.condition) {
      valid = false;
      if (f.highlight) {
        f.highlight.classList.add('error');
        setTimeout(() => f.highlight.classList.remove('error'), 800);
      } else {
        f.el.classList.add('error');
        setTimeout(() => f.el.classList.remove('error'), 800);
      }
    }
  });

  if (!valid) triggerButtonError();
  return valid;
}
document.getElementById('downloadBtn').addEventListener('click', () => {
   if (!validateInputs()) return;
  canvas.toBlob(blob => {
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = `${nameInput.value}-The Oath Beavers Association.png`;
    a.click();
    URL.revokeObjectURL(a.href);
  }, 'image/png');
});

document.querySelectorAll('.command').forEach(cmd => {
  cmd.addEventListener('click', () => {
    const text = cmd.textContent.trim();

    navigator.clipboard.writeText(text).then(() => {
      cmd.classList.add('copied');
      cmd.textContent = 'Panoya KopyalandÄ±';
      setTimeout(() => {
        cmd.classList.remove('copied');
        cmd.textContent = text;
      }, 1200);
    }).catch(() => {
      alert('Kopyalama baÅŸarÄ±sÄ±z ğŸ˜¢ TarayÄ±cÄ± izin vermiyor olabilir.');
    });
  });
});
</script>
</body>
</html>
