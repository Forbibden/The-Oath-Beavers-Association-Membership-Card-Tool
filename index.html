<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8">
<title>The Oath Beavers Association - Membership Card Creator Tool</title>
<link rel="icon" href="oath.png" type="image/png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">
</head>

<body>
<div class="page-wrapper">

  <section class="hero-section">
    <div class="card-section">

    <!-- SOL TARAF: FORM PANELİ -->
    <div class="panel">
      <span class="title">Üyelik Kartı Oluştur</span>

      <label>Fotoğraf</label>
      <input class="custom-file-input" type="file" id="photoInput" accept="image/*">
     
      <label>İsim</label>
      <input type="text" id="nameInput" placeholder="Ad Soyad">

      <label>Cinsiyet</label>
      <select id="sexInput">
        <option value="Female">Female</option>
        <option value="Male">Male</option>
      </select>

      <label>Servis</label>
      <select id="serviceInput">
        <option value="District Attorney’s Office">District Attorney’s Office</option>
        <option value="LS County Sheriff's Department">LS County Sheriff's Department</option>
        <option value="LS Police Department">LS Police Department</option>
        <option value="LS Fire Department">LS Fire Department</option>
        <option value="SA Department of Corrections">SA Department of Corrections</option>
        <option value="LS City Government">LS City Government</option>
      </select>

      <label>ID</label>
      <input type="text" id="idInput" placeholder="Yalnızca Ticket NO">
      <button id="downloadBtn" style="margin-top: 2rem;">PNG İndir</button>
    </div>
 <!-- SAĞ TARAF: KART ÖNİZLEME -->
    <div class="preview">
      <canvas id="cardCanvas"></canvas>
    </div>
  </div>

  </section>

  <!-- ÜYELİK KARTI OLUŞTURMA BÖLÜMÜ -->
   <section class="info-section">
    <div class="info-box">
      <span class="title">Üyelik Kartı Kullanım Rehberi</span>
      <p>
        /myitemsex (( note kağıdının envanterinizde hangi numarada olduğunu öğrenin))<br><br>

        /note x 1 ad <b>The Oath Beavers - Üyelik Kartı</b>
        (( x olan kısma envanterinizde note hangisindeyse onu yapın, unutmayın "The Oath Beavers - Üyelik Kartı" kartın adı bu olmak zorunda. ))<br><br>

        /iconpicker yazdıktan sonra önünüze gelen menüde "Diğer" kısmında yer alan üçüncü satırın soldan 4. simgeyi seçin.
        (( <a href="https://i.imgur.com/GnqvfVc.png" target="_blank">İkon görseli</a> ))<br><br>

        /note x 1 ikon (( bu komut iconpickerdan seçtiğiniz ikonu değiştirmenizi sağlar))<br><br>

        /note x 1 içerik https://i.imgur.com/Assokbk.jpeg
        (( burada olan imgur linkini sizin için hazırladığınız kart linkiyle değiştirin, imgura yüklenen fotoğrafa sağ tıklayıp “resim adresini kopyala” yaptıktan sonra gelen linki kullanabilirsiniz ))
      </p>
    </div>
   </section>
  <!-- ALT BİLGİ / REHBER ALANI -->

</div>
<script>
// Canvas işlemleri
const canvas = document.getElementById('cardCanvas');
const ctx = canvas.getContext('2d');
const nameInput = document.getElementById('nameInput');
const sexInput = document.getElementById('sexInput');
const serviceInput = document.getElementById('serviceInput');
const idInput = document.getElementById('idInput');
const photoInput = document.getElementById('photoInput');

let photoImg = null;
let templateImg = new Image();

templateImg.onload = () => {
  canvas.width = templateImg.width;
  canvas.height = templateImg.height;
  render();
};
templateImg.src = "sablon.png";

function render() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.drawImage(templateImg, 0, 0);

  if (photoImg) {
    const x = 392, y = 794.3, w = 348, h = 470;
    ctx.save();
    ctx.beginPath();
    ctx.rect(x, y, w, h);
    ctx.clip();
    drawImageCover(ctx, photoImg, x, y, w, h);
    ctx.restore();
  }

  ctx.fillStyle = '#000';
  ctx.textBaseline = 'top';
  ctx.font = 'bold 40px Arial';
  ctx.fillText(nameInput.value || '', 1000, 820);
  ctx.font = '40px Arial';
  ctx.fillText(sexInput.value || '', 1000, 867);
  ctx.fillText(serviceInput.value || '', 1000, 910);
  ctx.fillStyle = '#ff0000d9';
  ctx.fillText(idInput.value || '', 1000, 955);
}

function drawImageCover(ctx, img, x, y, w, h) {
  const iw = img.width, ih = img.height;
  const r = Math.max(w / iw, h / ih);
  const nw = iw * r, nh = ih * r;
  const cx = (nw - w) / 2, cy = (nh - h) / 2;
  ctx.drawImage(img, -cx + x, -cy + y, nw, nh);
}

photoInput.addEventListener('change', e => {
  const f = e.target.files[0]; 
  if (!f) return;
  const url = URL.createObjectURL(f);
  const img = new Image();
  img.onload = () => { photoImg = img; render(); };
  img.src = url;
});

[nameInput, sexInput, serviceInput, idInput].forEach(input => {
  input.addEventListener('input', render);
  input.addEventListener('change', render);
});

document.getElementById('downloadBtn').addEventListener('click', () => {
  canvas.toBlob(blob => {
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = `${nameInput.value}-The Oath Beavers Association.png`;
    a.click();
    URL.revokeObjectURL(a.href);
  }, 'image/png');
});

</script>
</body>
</html>
