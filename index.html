<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8">
<title>The Oath Beavers Association - Membership Card Creator Tool</title>
<link rel="icon" href="oath.png" type="image/png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
  margin: 0;
  font-family: 'Segoe UI', Arial, sans-serif;
  background: #0d0d0d;
  color: #f0f0f0;
  display: flex;
  min-height: 100vh;
}
.title{
  color: white;
  font-size: 1.25rem;
  font-weight: bold;
}
.container {
  display: flex;
  flex-direction: column;
  max-width: 800px;
  gap: 20px;
  margin: auto;
}
.card-section {
  display: flex;
  gap: 20px;
  background: #1a1a1a;
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.35);
}

/* Kart stili genel */
.card {
  background: #1a1a1a;
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.35);
  transition: transform 0.2s ease;
}
.card:hover {
  transform: translateY(-3px);
}

/* Kart Paneli */
.panel {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 5px;
}


label {
  font-size: 13px;
  margin-top: 6px;
  color: #bbb;
}

input, select {
  padding: 10px;
  margin-top: 4px;
  border-radius: 8px;
  border: 1px solid #333;
  background: #111;
  color: #f0f0f0;
  font-size: 14px;
  transition: border 0.2s;
}
input:focus, select:focus {
  border: 1px solid cadetblue;
  outline: none;
}

button {
  padding: 10px 14px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  background: cadetblue;
  color: #fff;
  font-weight: bold;
  transition: background 0.2s;
}
button:hover {
  background: #2891c7;
}
#downloadBtn {
  background: #2e7d32;
}
#downloadBtn:hover {
  background: #388e3c;
}

/* Önizleme */
.preview {
  flex: 1;
  background: #111;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 520px;
}

canvas {
  max-width: 100%;
  border-radius: 8px;
}
</style>
</head>

<body>
<div class="container">
  <div class="card-section">
    <div class="panel">
        <span class="title"> Üyelik Kartı Oluştur</span>
      <label>Fotoğraf</label>
      <input type="file" id="photoInput" accept="image/*">

      <label>İsim</label>
      <input type="text" id="nameInput" placeholder="Ad Soyad">

      <label>Cinsiyet</label>
      <select id="sexInput">
        <option value="Female">Female</option>
        <option value="Male">Male</option>
      </select>

      <label>Servis</label>
      <select id="serviceInput">
        <option value="District Attorney’s Office">District Attorney’s Office</option>
        <option value="LS County Sheriff's Department">LS County Sheriff's Department</option>
        <option value="LS Police Department">LS Police Department</option>
        <option value="LS Fire Department">LS Fire Department</option>
        <option value="SA Department of Corrections">SA Department of Corrections</option>
        <option value="LS City Government">LS City Government</option>
      </select>

      <label>ID</label>
      <input type="text" id="idInput" placeholder="Yalnızca Ticket NO">

      <button id="updateBtn" style="margin-top: 2rem;">Önizle</button>
      <button id="downloadBtn">PNG İndir</button>
    </div>

    <div class="preview">
      <canvas id="cardCanvas"></canvas>
    </div>
  </div>
</div>

<script>
// Canvas işlemleri
const canvas = document.getElementById('cardCanvas');
const ctx = canvas.getContext('2d');
const nameInput = document.getElementById('nameInput');
const sexInput = document.getElementById('sexInput');
const serviceInput = document.getElementById('serviceInput');
const idInput = document.getElementById('idInput');
const photoInput = document.getElementById('photoInput');

let photoImg = null;
let templateImg = new Image();

templateImg.onload = () => {
  canvas.width = templateImg.width;
  canvas.height = templateImg.height;
  render();
};
templateImg.src = "sablon.png";

function render() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.drawImage(templateImg, 0, 0);

  if (photoImg) {
    const x = 392, y = 794.3, w = 348, h = 470;
    ctx.save();
    ctx.beginPath();
    ctx.rect(x, y, w, h);
    ctx.clip();
    drawImageCover(ctx, photoImg, x, y, w, h);
    ctx.restore();
  }

  ctx.fillStyle = '#000';
  ctx.textBaseline = 'top';
  ctx.font = 'bold 40px Arial';
  ctx.fillText(nameInput.value || '', 1000, 820);
  ctx.font = '40px Arial';
  ctx.fillText(sexInput.value || '', 1000, 867);
  ctx.fillText(serviceInput.value || '', 1000, 910);
  ctx.fillStyle = '#ff0000d9';
  ctx.fillText(idInput.value || '', 1000, 955);
}

function drawImageCover(ctx, img, x, y, w, h) {
  const iw = img.width, ih = img.height;
  const r = Math.max(w / iw, h / ih);
  const nw = iw * r, nh = ih * r;
  const cx = (nw - w) / 2, cy = (nh - h) / 2;
  ctx.drawImage(img, -cx + x, -cy + y, nw, nh);
}

photoInput.addEventListener('change', e => {
  const f = e.target.files[0]; 
  if (!f) return;
  const url = URL.createObjectURL(f);
  const img = new Image();
  img.onload = () => { photoImg = img; render(); };
  img.src = url;
});

document.getElementById('updateBtn').addEventListener('click', render);
document.getElementById('downloadBtn').addEventListener('click', () => {
  canvas.toBlob(blob => {
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = `${nameInput.value}-The Oath Beavers Association.png`;
    a.click();
    URL.revokeObjectURL(a.href);
  }, 'image/png');
});
</script>
</body>
</html>
